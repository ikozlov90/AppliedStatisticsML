\documentclass[9pt]{beamer}




\usepackage{beamerthemesplit}
\usetheme{Boadilla}
\usecolortheme{orchid}

\usepackage{cmap}



 % \usepackage[cp866]{inputenc}                %%% Є®¤Ёа®ўЄ  DOS
  \usepackage[cp1251]{inputenc}
%  \usepackage[T2A]{fontenc}                %%% ???
%\usepackage[english,russian]{babel}
%\usepackage[russian]{babel}
 \usepackage[OT1]{fontenc}
%\usepackage[english]{babel}
\usepackage[russian]{babel}

\usepackage{amssymb,latexsym, amsmath, mathdots}

\usepackage{amscd}
\usepackage{multirow}
\usepackage{comment}

\usepackage{epstopdf}



%\usepackage[table]{xcolor} %colored cells

%\usepackage{tikz}
%\usetikzlibrary{tikzmark} %arrows in tables


\usepackage{mnsymbol} % udots in matrices


 \usepackage{pgfpages}
%\setbeameroption{show notes}
%\setbeameroption{show notes on second screen=bottom}
%% \setbeameroption{show notes on second screen}

%\setbeamercolor{alerted text}{fg=red!80!black}


% \setbeamercolor{alerted text}{fg=blue!50!green}
% \setbeamercolor{fortheorem}{bg=blue!15!white}
% \setbeamercolor{EMPF}{bg=blue!25!white}
% \setbeamercolor{EMPF2}{bg=blue!35!white}

%\setbeamersize{text margin left=5.mm, text margin right=5.mm}


%---------------------------------------------------------------------------------------------------------------------------

%\def\emphbox#1#2#3{\begin{beamercolorbox}[wd=#2, ht=#1, center, colsep=1.mm]{EMPF} #3 \end{beamercolorbox}}

%---------------------------------------------------------------------------------------------------------------------------


%\advance\leftskip-5.mm



%***************************************************************************************************************************

\theoremstyle{theorem}
\newtheorem{mytheorem}[theorem]{Теорема}
\newtheorem{mylemma}[theorem]{Лемма}
\newtheorem{mycorollary}[theorem]{Следствие}

\newtheorem{proposition}[theorem]{Предложение}
\newtheorem{assertion}[theorem]{Утверждение}
\newtheorem{remark}[theorem]{Замечание}
\newtheorem{assumption}[theorem]{Предположение}

\newtheorem{convention}[theorem]{Договорённость}
\newtheorem{question}[theorem]{Вопрос}
%\newtheorem{mydefinition}{mydefinition}

\theoremstyle{definition}
\newtheorem{mydefinition}[theorem]{Определение}
\newtheorem{myexample}[theorem]{Пример}



%***************************************************************************************************************************

\chardef\No=194
\newcommand{\bd}{{\rm bd}}
\newcommand{\cl}{{\rm cl}}
\newcommand{\ind}{{\rm ind}}
\newcommand{\id}{{\rm id}}
\newcommand{\inj}{{\sl in}}
\newcommand{\pr}{{\rm pr}}
\newcommand{\st}{{\rm St}}


\DeclareMathOperator{\sgrad}{sgrad}

\DeclareMathOperator{\cnt}{const}

\DeclareMathOperator{\Aut}{Aut}


\DeclareMathOperator{\sgn}{sgn}

\DeclareMathOperator{\Int}{Int}


\DeclareMathOperator{\tr}{tr}

\DeclareMathOperator{\Mat}{Mat}







%****************************************************************************
\newcommand{\Ker}{\mathrm{Ker}\,\,}
\newcommand{\Ann}{\mathrm{Ann}\,\,}

\newcommand{\Imm}{\mathrm{Im}\,\,}

\newcommand{\rk}{\mathrm{rk}\,\,}

\newcommand{\const}{\mathrm{const}}



\DeclareMathOperator{\Pen}{\mathcal{P}}


\DeclareMathOperator{\Core}{K}


\DeclareMathOperator{\BLG}{\operatorname{BLG}}

\DeclareMathOperator{\AutBP}{\operatorname{Aut}(V, \mathcal{P})}


\def\minus{\hbox{-}}   %Sign of minus in big matrices

\usepackage{multirow}  %Columns spanning multiple rows

\usepackage[normalem]{ulem} %underline that can break lines

%\usepackage[normalem]{ulem}


\usepackage{wasysym} %smilies


%****************************************************************************



\title% [] (optional, only for long titles)
{Прикладная статистика в машинном обучении \\ Семинар 9 \\ Байесовский взгляд на подбор моделей}
%\subtitle{}
\author [И. \,К.~Козлов] %(optional, for multiple authors)
{И. \,К.~Козлов \\ {\footnotesize(\textit{Мехмат МГУ})}}


\date % [](optional)
{2022}
%\subject{Mathematics}







\usepackage{hyperref}
%\hypersetup{unicode=true}
\hypersetup{
  colorlinks=true,
  linkcolor=green!70!black, %blue!50!red,
  urlcolor=green!70!black,
  unicode=true
}


\begin{document}

%\includeonlyframes{}
\frame{\titlepage}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Сразу съедим лягушку}
%----------------------------------------------------------


\begin{center}
\Huge Настало время съесть лягушку!
\end{center}


\begin{figure}[h!]
\center{\includegraphics[width=0.5\textwidth]{pic/Frog}}
%\caption{Не тот Симпсон} \label{Fig:}
\end{figure}

\vspace{2mm}

\begin{center}
\Large Обсудим достаточные статистики экспоненциального класса!
\end{center}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\section{Достаточные статистики}



\begin{frame}[plain]\frametitle{Достаточные статистики} \tableofcontents[currentsection]\end{frame}



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Достаточные статистики}
%----------------------------------------------------------


\begin{block}{Теорема факторизации Фишера}
$T(x)$ --- достаточная статистика $\Leftrightarrow$ существует разложение \[  f(x \,\, | \,\, \theta) =h(x)\,q(\theta, T(x)).\] \end{block}

\vspace{5mm}

Докажем эту теорему в \textbf{дискретном случае}. В общем случае --- см. Wikipedia:

\vspace{5mm}

\begin{center}
\url{https://en.wikipedia.org/wiki/Sufficient_statistic}
\end{center}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Достаточные статистики}
%----------------------------------------------------------

\textbf{Доказательство теоремы факторизации}.

\vspace{5mm}

\begin{itemize}

\item[$({\color{red} \Rightarrow})$.] Пусть  $S(x)$ --- достаточная, т.е. $\mathbb {P} (X \,\, | \,\, \mathrm {T}=t)$ не зависит от $\theta$. 

\vspace{5mm}

Обозначим $t = T(x)$. Тогда


\begin{figure}[h!]
\center{\includegraphics[width=0.75\textwidth]{pic/Dec}}
%\caption{} \label{Fig:}
\end{figure}

\vspace{2mm}

Это и есть нужное разложение:  \[ f(x \,\, | \,\, \theta) =h(x)\,q(\theta, T(x)).\]

\end{itemize}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Достаточные статистики}
%----------------------------------------------------------

\begin{itemize}

\item[$({\color{red} \Leftarrow})$.] (В дискретном случае). Пусть \begin{equation} \label{Eq:2} f(x \,\, | \,\, \theta) =h(x)\,q(\theta, T(x)).\end{equation}

\vspace{2mm}

По определению условной вероятности \[\mathbb {P} (X  =x \,\, | \,\, \mathrm {T}=t) = \frac{\mathbb {P} (X  =x, \mathrm {T}=t)}{\mathbb {P} (\mathrm {T} =t)} = \frac{\mathbb {P} (X  =x)}{\mathbb {P} (\mathrm {T}=t)}. \] 

\pause

\vspace{2mm}

Числитель равен $f(x;\theta)$, а знаменатель --- сумма вероятностей событий \[\mathbb {P} (\mathrm {T} =t) = \sum_{x':T(x') = t} f(x'; \theta)\]


Подставляем $\eqref{Eq:2}$: \[\mathbb {P} (X  =x \,\, | \,\, \mathrm {T}=t) =\frac{f(x;\theta)}{\sum_{x':T(x') = t} f(x'; \theta)} = \frac{ {\color{red}q(\theta, t) } h(x)}{{\color{red}q(\theta, t) } \sum_{x':T(x') = t} h(x')}\]

\vspace{2mm}

\pause

${\color{red}q(\theta, t) }$ сокращается. Что и требовалось --- $\mathbb {P} (X  =x \,\, | \,\, \mathrm {T} (X)=t) $ не зависит от $\theta$.


\end{itemize}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\section{Экспоненциальное семейство распределений}



\begin{frame}[plain]\frametitle{Экспоненциальное семейство распределений} \tableofcontents[currentsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Экспоненциальный класс}
%----------------------------------------------------------


\begin{center}
\noindent\fbox{%
    \parbox{17em}{%


\vspace{3mm}



    \Large \textbf{\hspace{3mm}\color{blue} Экспоненциальный класс}
    
\vspace{3mm}    
    }%
}

\vspace{5mm}


\end{center}



Семейство распределений, чья плотность может быть представлена в виде: \[ f(x | \theta)  = \frac{h(x) }{g(\theta)} \operatorname{exp} \left( \theta^T u(x) \right), \] 

\begin{itemize}

\item $h(x) \geq 0$, 

\vspace{5mm}

\item $ \theta^T u(x)$ означает $\theta_1 u_1(x) + \dots + \theta_k u_k(x)$,

\vspace{5mm}

\item Чтобы интеграл от плотности равнялся единице: \[ g(\theta) = \int h(x)  \operatorname{exp} \left( \theta^T u(x) \right) dx. \]  

\end{itemize}



%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Экспоненциальное семейство}
%----------------------------------------------------------


Как мы помним, {\color{red} $u_j(x)$} --- достаточные статистики:

 \[ f(x | \theta)  = \frac{h(x) }{g(\theta)} \operatorname{exp} \left( \theta^T {\color{red} u(x)} \right). \] 

\vspace{2mm}

\pause

\begin{block}{} Их моменты выражаются через производную $g(\theta)$:


\vspace{3mm}

\begin{itemize}

\item Матожидание \[ \mathbb{E} (u_j)  = \frac{\partial \ln g(\theta)}{\partial \theta_j}.\]


\vspace{2mm}

\item Матрица ковариации \[ \operatorname{Cov} (u_i, u_j)  = \frac{\partial^2 \ln g(\theta)}{\partial \theta_i \partial \theta_j}.\]

\end{itemize}

\end{block}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Экспоненциальное семейство}
%----------------------------------------------------------


\textbf{Доказательство}. Докажем для матожидания, для ковариации --- аналогично.

\vspace{5mm}

\begin{itemize}

\item \textbf{Q:} Если $\displaystyle  f(x | \theta)  = \frac{h(x) }{g(\theta)} \operatorname{exp} \left( \theta^T  u(x) \right)$, то чему равна $g(\theta)$? 

\vspace{5mm}


\pause

\item \textbf{A:} Это нормировочная константа: \[  g(\theta) = \int_{-\infty}^{\infty} h(x) \operatorname{exp} \left( {\color{blue} \theta^T} u(x) \right) dx.\]

\vspace{2mm}

\item \textit{Ну конечно, интеграл можно продифференцировать по параметру}: \[  \frac{\partial \ln g(\theta)}{\partial \theta_j}  =   \frac{1}{g(\theta)} \frac{\partial g(\theta)}{\partial \theta_j}   =  
\int_{-\infty}^{\infty}{\color{blue} u_j(x)}  \frac{ h(x)}{g(\theta)} \operatorname{exp} \left( {\color{blue} \theta^T} u(x) \right)  dx   =  \mathbb{E} \left( u_j(x)  \right). \]

\end{itemize}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Вычисления упрощаются}
%----------------------------------------------------------



\begin{figure}[h!]
\center{\includegraphics[height=0.8\textheight]{pic/BAD}}
%\caption{} \label{Fig:}
\end{figure}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\section{Дифферецирование}

\begin{frame}[plain]\frametitle{Дифферецирование} \tableofcontents[currentsection]\end{frame}

\subsection{Дифферециал}

\begin{frame}[plain]\frametitle{Дифферециал} \tableofcontents[currentsubsection]\end{frame}




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------


\begin{center}
\Large Наши мучения не заканчиваются) 

Давайте вспомним --- как {\color{red} дифференцировать функции}. 
\end{center}

\vspace{2mm}

\begin{figure}[h!]
\center{\includegraphics[height=0.65\textheight]{pic/Frog2}}
%\caption{} \label{Fig:}
\end{figure}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{block}{} Пусть $f : M^n  \to N^m$ --- гладкое отображение. Тогда в каждой точке $p \in M^n$ определён {\color{blue} дифференциал} отображения \[ d_p f: T_{p} M^n \to T_{f(p)} N^m.\]
\end{block} 

\begin{figure}[h!]
\center{\includegraphics[width=0.8\textwidth]{pic/Diff1}}
%\caption{} \label{Fig:}
\end{figure}

\vspace{2mm}

\pause

Жёлтая кривая $\gamma_M(t)$ на $M$ переходит в жёлтую кривую $\gamma_N(t)$  на $N$.

\vspace{2mm}

Дифференциал $d_p f$ переводит вектор скорости $\displaystyle \frac{d\gamma_M}{dt}$ в вектор скорости $\displaystyle \frac{d\gamma_N}{dt}$.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------




%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

Мы будем считать, что \textit{$M^n$ и $N^m$ --- области в $\mathbb{R}^n$ и $\mathbb{R}^m$} соответственно. 

\vspace{5mm}

Поэтому дифференциал будет линейным отображения \[ d_p f: \mathbb{R}^m \to \mathbb{R}^n\]

\vspace{2mm}

Будем писать $d_p f = df$ для краткости.

\vspace{2mm}

Как правильно вычислять в криволинейных координатах --- учит {\color{red} дифференциальная геометрия}.


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

Рассмотрим примеры:

\vspace{2mm}

\begin{itemize}

\item \textbf{Функция.} $f(x): \mathbb{R} \to \mathbb{R}$. Какой вид имеет дифференциал?

\pause

 \[ df(x) = f'(x) dx\]

\end{itemize}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{itemize}

\item \textbf{Функцию от вектора} $f(x^1, \dots, x^n): \mathbb{R}^n \to \mathbb{R}$. Дифференциал?

\pause

 \[ df(x)  = \sum_{i=1}^n \frac{\partial f}{\partial x^i}  dx^i.\]
 
Вектор частных производных\footnote{в евклидовых координатах} --- {\color{blue} градиент функции}: \[ \nabla f = \left(\frac{\partial f}{\partial x^1}, \dots, \frac{\partial f}{\partial x^n} \right).\] Поэтому дифференциал --- формальное скалярное произведение \[  df(x) = \langle \nabla f, dx \rangle \]


\end{itemize}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{itemize}

\item Далее --- дифференциал \textbf{вектор-функции от вектора} \[ y^i = f^i(x^1, \dots, x^n), \qquad i = 1, \dots, m.\] 

\pause

Дифференциал   \[ df(x)  = J_f (x) dx,\] где {\color{blue} матрица Якоби} \[ J_f = \left(\begin{matrix}{\dfrac {\partial f^{1}}{\partial x^{1}}}&\cdots &{\dfrac {\partial f^{1}}{\partial x^{n}}}\\\vdots &\ddots &\vdots \\{\dfrac {\partial f^{m}}{\partial x^{1}}}&\cdots &{\dfrac {\partial f^{m}}{\partial x^{n}}}\end{matrix}\right). \]


 
\end{itemize}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{itemize}

\item \textbf{Функция от матрицы} $f(X)$, где $X$ --- $m \times n$ матрица. 

\vspace{5mm}

\textbf{Q:} Какой размер у матрицы дифференциала?

\pause

\vspace{5mm}

\textbf{A:} $m \times n$ как у $X$. Пусть $X^{ij}$ --- компоненты $X$. Дифференциал: \[ df(X) = \sum_{i,j} \frac{\partial f}{\partial X^{ij}} dX^{ij} = \langle \nabla f, dX\rangle \]
 
\end{itemize}




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------


\begin{block}{Утверждение}
Для любых $m \times n$ матриц $A, B$ \[ \langle A, B \rangle = \operatorname{tr} (A^T B).\]
\end{block}

\vspace{5mm}

\pause

\textbf{Доказательство}. Обозначим $A = \left( a_{ij}\right), B= \left( b_{ij}\right)$ и $C = A^TB = \left( c_{ij}\right)$. Тогда \[ c_{ij} = \sum_{k=1}^m a_{ki}b_{kj}. \]

\pause

Поэтому 
\[ \operatorname{tr} (A^TB) = \sum_{i=1}^n \sum_{k=1}^m a_{ki}b_{ki} = \langle A, B \rangle. \]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{center}
\Huge Итого:
\end{center}

\vspace{5mm}

\begin{figure}[h!]
\center{\includegraphics[width=0.9\textwidth]{pic/Diff2}}
%\caption{} \label{Fig:}
\end{figure}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\subsection{Свойства дифферециала}

\begin{frame}[plain]\frametitle{Свойства дифферециала} \tableofcontents[currentsubsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{center}
\Large Свойства дифференциала.
\end{center}


\begin{enumerate}

\item Это \textbf{линейный функционал}:

\[ d(X + Y) = dX + dY, \qquad d(\alpha X ) = \alpha d(X).\]

\vspace{2mm}

Если $A, B$ --- постоянные матрицы, то \[ d(AXB)  = A d(X) B.\]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{enumerate}

\setcounter{enumi}{1}

\item {\color{blue} Правило Лейбница} \[ d (fg) = (df) g + f (dg)\]

\vspace{2mm}

С обычного произведения оно продолжается на матричные произведения:
\[d(XY) = (dX) Y + X(dY) \] и скалярные произведения \[d \langle X, Y \rangle =   \langle d X, Y \rangle  +  \langle X, dY \rangle. \]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\begin{enumerate}

\setcounter{enumi}{2}

\item {\color{blue} Производная сложной функции}. 

\vspace{5mm}

Дифференциал композиции отображений \[M \xrightarrow{f} N \xrightarrow{g} P  \]  будет композицией дифференциалов \[ d_x f(g(x)) = d_{f(x)} g \circ d_x g(x). \]

\pause

\vspace{5mm}

В координатах \[ {\color{blue}  \frac{\partial f(g(x))}{\partial x^i} = \sum_j \frac{\partial f}{\partial g^j} \frac{\partial g^j}{\partial x^i}}.\]

\end{enumerate}


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

\subsection{Примеры вычисления}

\begin{frame}[plain]\frametitle{Примеры вычисления} \tableofcontents[currentsubsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\textbf{Q:} Найти дифференциал \[d \left(X^{-1}\right) = ?\]

\pause

\vspace{5mm}

\textbf{A:} Дифференцируем тождество \[X^{-1} X = E.\] По правилу Лейбница \[ d\left(X^{-1}\right) X + X^{-1} dX = 0,\] откуда \[ {\color{red} d\left(X^{-1}\right) = - X^{-1} d(X) X^{-1}}.\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\textbf{Q:} Найти градиент \[\nabla \left(\operatorname{tr} AXBX^{-1} \right)= ? \]

\pause

\vspace{5mm}

\textbf{A:} Найдём его из свойства \[ \operatorname{tr} \left[\left(\nabla f \right)^T dX \right].\] 

След --- линейный оператор, поэтому \[  {\color{red} d \left(\operatorname{tr} X\right)  = \operatorname{tr}\left(d X\right)}.\] Далее используем правило Лейбница \[ d \left(\operatorname{tr} AXBX^{-1} \right) =  \operatorname{tr} \left( Ad(X)BX^{-1} \right) +\operatorname{tr} \left( AXB d(X^{-1} )\right). \]

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

Подставляя $d(X^{-1})$ получаем \[ d \left(\operatorname{tr} AXBX^{-1} \right) =  \operatorname{tr} \left( Ad(X)BX^{-1} \right) -\operatorname{tr} \left( AXB X^{-1} d(X) X^{-1}\right). \]

\pause

\vspace{2mm}


Приводим выражение к виду \[ \operatorname{tr} \left[\left(\nabla f \right)^T dX \right],\] используя свойства следа \[ \operatorname{tr} A = \operatorname{tr} A^T, \qquad \operatorname{tr} AB = \operatorname{tr} BA.\]

\vspace{2mm}

\pause
Получаем \[ d \left(\operatorname{tr} AXBX^{-1} \right)  = \operatorname{tr}\left[ \left(A^T X^{-T} B^T A - X^{-T} B^T X^T A^T X^{-T} \right)^T  dX\right]\]


\textbf{Ответ}: \[{\color{red} \nabla f = A^T X^{-T} B^T A - X^{-T} B^T X^T A^T X^{-T}}.\]




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\textbf{Q:} Найти дифференциал \[ d \ln \left( \operatorname{det} X\right) = ?\]

\pause

\vspace{5mm}

\textbf{A:} Производная сложной функции: \[  d \ln \left( \operatorname{det} X\right)  = \frac{ d \left( \operatorname{det} X\right)}{ \operatorname{det} X}.\]


Далее вспомним пару фактов о матрицах.

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

Рассмотрим произвольную матрицу $A = \left( a_{ij} \right)$.

\vspace{5mm}

Обозначим $A_{ij}$ --- алгебраические дополнения к $a_{ij}$.

\vspace{5mm}

\pause

\begin{itemize}

\item {\color{red} $\det A$ --- многочлен от $a_{ij}$};

\vspace{5mm}

\item {\color{blue} Разложения определителя по строке/столбцу}: \[{\displaystyle \det A=\sum _{j=1}^{n}a_{ij}A_{ij}=\sum _{i=1}^{n}a_{ij}A_{ij}}.\] 

\end{itemize}

\pause


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------


\begin{block}{} 
\begin{enumerate}

\item частные производные определителя --- алгебраические дополнения \begin{equation} \label{Eq:DetMatrixDeriv}  \frac{\partial \det A}{\partial a_{ij}} = A_{ij}, \end{equation} 

\pause

\vspace{2mm}

\item элементы обратной матрицы --- это алгебраические дополнения $A_{ji}$, делённые на определитель: \[{\displaystyle A^{-1}={\frac {1}{\det(A)}}\operatorname {adj} (A)}, \qquad  \text{где } \qquad \operatorname {adj} (A)_{ij} = A_{ji}.\]

\end{enumerate}

\end{block} 

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Дифферецирование}
%----------------------------------------------------------

\textbf{Ответ:} \[ {\color{red} d \ln \left( \operatorname{det} X\right) = \langle X^{-T}, dX\rangle}.\]


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\subsection{Гессиан}

\begin{frame}[plain]\frametitle{Гессиан} \tableofcontents[currentsubsection]\end{frame}

%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Гессиан}
%----------------------------------------------------------



Матрицу вторых производных называют {\color{blue} гессианом} и обозначают $\mathbf{H}_f$ или $\nabla^2 f$: \[{\displaystyle \nabla^2 {f}= \left({\frac {\partial ^{2}f}{\partial x_{i}\,\partial x_{j}}}\right).}\] 


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Гессиан}
%----------------------------------------------------------

\begin{center}
\textbf{Формальное вычисление гессиана}. 
\end{center}

\vspace{5mm}

\begin{itemize}

\item Берём дифференциал \[ d f(x) = \langle \nabla f(x), dx\rangle. \] 

\vspace{2mm}

\item Меняем $dx \to dx_1$.


\vspace{5mm}

\item Ещё раз берём дифференциал \[ d  \langle \nabla f(x), dx_1\rangle =    \langle d \left(\nabla f(x)\right), dx_1\rangle = \langle \nabla^2 f(x) dx_2, dx_1\rangle.\]

\end{itemize}
%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Гессиан}
%----------------------------------------------------------

\textbf{Q:} Найти гессиан квадратичной функции \[ f(x) = \frac{1}{2} \langle x, A x \rangle + b^T x +c, \qquad x \in \mathbb{R}^n.\]

\pause

\vspace{2mm}

\textbf{A:} Находим дифференциал \[ df(x) = \langle Ax + b, dx\rangle. \]

\vspace{5mm}

И ещё раз берём дифференциал \[ d (Ax + b) = A.\]


\textbf{Ответ}: ${\color{red} \nabla^2 f = A}$.




%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------


\subsection{Памятка}

\begin{frame}[plain]\frametitle{Памятка} \tableofcontents[currentsubsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Памятка}
%----------------------------------------------------------


\begin{figure}[h!]
\center{\includegraphics[width=0.9\textwidth]{pic/Diff3}}
%\caption{} \label{Fig:}
\end{figure}

%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------



\end{document}


\section{Байесовский подбор гиперпараметров}



\begin{frame}[plain]\frametitle{Байесовский подбор гиперпараметров} \tableofcontents[currentsection]\end{frame}


%----------------------------------------------------------
\begin{frame}[plain]\frametitle{Основная задача статистики}
%----------------------------------------------------------

Байесовский подбор гиперпараметров


%----------------------------------------------------------
\end{frame}
%----------------------------------------------------------

\end{document}

